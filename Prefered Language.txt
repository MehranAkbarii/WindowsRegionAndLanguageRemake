namespace <app namespace>
{
    public partial class <form class name> : Form
    {
        List<string> languageList = new List<string>();

        public MainForm()
        {
            InitializeComponent();
        }

        private void <form class name>(object sender, EventArgs e)
        {
            // Load the language list when the form loads
            LoadLanguageList();
        }

        private void LoadLanguageList()
        {
            // Retrieve the current language list    
            // Display the language list in the ListBox
            listBoxLanguages.DataSource = languageList;
        }

        private void MoveLanguage(bool moveUp)
        {
            int selectedIndex = listBoxLanguages.SelectedIndex;
            if (selectedIndex < 0)
            {
                MessageBox.Show("Please select a language first.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                return;
            }

            if (moveUp && selectedIndex > 0)
            {
                // Swap the selected language with the one above it
                string temp = languageList[selectedIndex];
                languageList[selectedIndex] = languageList[selectedIndex - 1];
                languageList[selectedIndex - 1] = temp;
            }
            else if (!moveUp && selectedIndex < languageList.Count - 1)
            {
                // Swap the selected language with the one below it
                string temp = languageList[selectedIndex];
                languageList[selectedIndex] = languageList[selectedIndex + 1];
                languageList[selectedIndex + 1] = temp;
            }

            // Update the ListBox with the new language order
            listBoxLanguages.DataSource = null;
            listBoxLanguages.DataSource = languageList;
            listBoxLanguages.SelectedIndex = selectedIndex + (moveUp ? -1 : 1);
        }

        private void btnMoveUp_Click(object sender, EventArgs e)
        {
            MoveLanguage(true);
        }

        private void btnMoveDown_Click(object sender, EventArgs e)
        {
            MoveLanguage(false);
        }

        private void btnSave_Click(object sender, EventArgs e)
        {
            // Computer\HKEY_CURRENT_USER\SOFTWARE\Microsoft\CTF\SortOrder\Language
            // Save the updated language list
        }
    }
}